# 파일 입출력



## 목차

- 파일과 스트림(Stream), 그리고 기본적인 파일의 입출력
- 파일의 개방 모드(Mode)
- 파일 입출력 함수의 기본
- 텍스트 데이터와 바이너리 데이터를 동시에 입출력 하기



## 파일과 스트림(Stream), 그리고 기본적인 파일의 입출력

이번 챕터에서 공부할 내용은 파일이다. 그런데 파일은 운영체제에 의해서 관리가 되기 때문에 운영체제와 파일의 관계를 이해하는 데서부터 시작할 필요가 있다.



> 저기 저 파일에 저장되어 있는 데이터를 읽고 싶어요.

프로그램상에서 파일에 저장되어 있는 데이터를 참조하길 원한다고(읽기 원한다고) 가정해 보자.  
이 때 제일먼저 해야 할 일은 무엇일까? 그것은 우리가 구현한 프로그램과 참조할 데이터가 저장되어 있는 파일 사이에 데이터가 이동할 수 있는 다리를 놓는 일이다.  
이러한 데이터 이동의 경로가 되는 다리를 가리켜 '스트림(stream)'이라 하는데, 스트림에 대해서는 앞서 Chapter 21에서 이미 설명한바 있다.  
즉 프로그램과 파일 사이에 스트림을 형성해야 데이터를 주고 받을 수 있다.

![](./img/4-4/ex1.jpg)

앞선 챕터에서도 언급했지만, 스트림이라는 것은 운영체제에 의해서 형성되는 소프트웨어적인 상태를 의미하는 것일 뿐, 실제로 위 그림과 같은 형태의 다리가 놓여지는 것은 아니다.  
따라서 프로그램과 파일 사이에 스트림이 형성되었다고 하면 다음과 같이 이해하기 바란다.

__파일로부터 데이터를 읽어 들일(파일에 데이터를 쓸) 기본적인 준비가 완료되었구나__

그런데 파일은 운영체제에 의해서 그 구조가 결정되고 관리되는 대상이기 때문에, 파일 뿐만 아니라 스트림의 형성도 운영체제의 몫임을 기억해야 한다.



> fopen 함수호출을 통한 파일과의 스트림 형성과 FILE 구조체

다음은 스트림을 형성할 때 호출하는 함수이다. 이 함수의 호출을 통해서 프로그램상에서 파일과의 스트림을 형성할 수 있다.

```c
#include <stdio.h>

FILE * fopen(const char * filename, const char * mode);
// 성공 시 해당 파일의 FILE 구조체 변수의 주소 값, 실패 시 NULL 포인터 반환
```

위 함수의 첫 번째 인자로는 스트림을 형성할 파일의 이름을, 두 번째 인자로는 형성할 스트림의 종류에 대한 정보를 문자열의 형태로 전달한다.  
그러면 이 함수는 해당 파일과의 스트림을 형성하고 스트림 정보를 FILE 구조체 변수에 담아서 그 변수의 주소 값을 반환한다.  
간단하게나마 fopen 함수에 대해서 소개를 했는데 많이 부족한 것이 사실이다. 그러나 이제부터 하나씩 알아가면 된다. 그럼 fopen 함수의 반환형을 다시 보자.  
FILE이라는 이름의 기본 자료형이 존재하지 않으니 이는 분명 구조체의 이름이다. 그렇다면 이 구조체는 어떻게 정의되어 있으며 무엇에 사용되는 것일까?  
사실 FILE 구조체가 어떻게 정의되어 있는지를 알 필요는 없다. FILE 구조체 변수의 맴버에 직접 접근 할 일이 없기 때문이다.  
위 함수가 반환하는 FILE 구조체의 포인터는 파일을 가리키기 위한 용도로 사용된다. 즉 이 포인터를 이용해서 파일에 데이터를 저장하거나 파일에 저장된 데이터를 읽게 된다. 따라서 FILE 구조체가 어떻게 정의되어 있는지를 알 필요는 없다.

![](./img/4-4/ex2.jpg)

위 그림은 프로그램 상에서 fopen 함수를 호출했을 때 일어나는 일들을 정리해 놓은 것이다. 위 그림에서 주목할 부분은 다음 세 가지이다.

- fopen 함수가 호출되면 FILE 구조체 변수가 생성된다.
- 생성된 FILE 구조체 변수에는 파일에 대한 정보가 담긴다.
- FILE 구조체의 포인터는 사실상 파일을 가리키는 '지시자'의 역할을 한다.

일단은 이 정도만 이해를 하자. 어차피 위의 그림은 fopen 함수를 호출하는 예제를 작성해봐야 완벽히 이해할 수 있다.



> 입력 스트림과 출력 스트림의 생성








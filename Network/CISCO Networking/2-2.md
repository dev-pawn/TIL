# 라우터, 그 속으로 전진!



## 목차

- 네트워크 접근 제어 엑세스 리스트(Access List)
- 엑세스 리스트에서 이것만 알면 다 안다!
- 스탠더드 엑세스 리스트의 시작
- 스탠더드 엑세스 리스트의 예제
- 텔넷포트(VTY Port)에서의 엑세스 리스트
- 익스텐디드 엑세스 리스트(Extended Access List)
- 라우터의 장애 대비 HSRP
- IP 주소의 변환 NAT(Network Address Translation)



## 네트워크 접근 제어 엑세스 리스트(Access List)

여기에서는 우리가 라우터를 할 때 꼭 알아두어야 하는, 그러나 왜 그런지 부담스럽고 조금은 어려운 듯한, 그러나 알고 보면 별로 안 어려운 '엑세스 리스트(Access List)'라는 명령에 대해서 알아보기로 하겠습니다.

그럼 엑세스 리스트란 무엇을 뜻할까요?

엑세스 리스트란 한마디로 말해서 네트워크에 엑세스, 즉 접근을 하게 해줄까, 말까를 미리 정해놓은 리스트라고 생각하면 됩니다. 즉 어떤 녀석에게는 어디만 보여주고, 또 어떤 녀석에게는 어디만 쓰게 해야겠다 하고 정해 놓은 표를 의미합니다.

이러한 엑세스 리스트는 주로 보안을 위해서 사용되고 있습니다. 요즘 들어서는 그 중요성을 모두 인식하는 추세여서 점점 많이 사용되고 있습니다. 물론 라우터에 세팅이 됩니다. 그러니까 당연히 라우터가 볼 수 있는 한계, 즉 네트워크 계층까지만 관리가 되겠죠?  
하지만 요즘은 라우터도 네트워크 계층만 보는 것이 아니라 애플리케이션 계층까지 관리하는 여러 가지 기능이 나와있기 때문에 꼭 네트워크 계층까지만이라고 단정할 수는 없습니다. 그냥 일반적으로는 그렇다는 겁니다.

어떤 분들은 라우터의 엑세스 리스트가 있는데, 왜 파이어월(방화벽) 같은 보안 장비를 따로 두는지 궁금해 합니다.

정확히 말하자면 우리가 배울 라우터의 엑세스 리스트는 모든 침입자를 완벽하게 막아낼 수는 없습니다. 또 관리 자체도 쉽지가 않습니다. 즉 피지컬 계층에서 애플리케이션 계층까지를 완벽하게 말아줄 수 있고 많은 보안 기능을 가지고 있는 전문 보안 서버가 필요하게 된 겁니다.

그런데 요즘은 라우터에도 이러한 파이어월용 소프트웨어를 같이 넣어서 운용할 수 있으니까 혹시 라우터만 가지고 계신 분은 한번 알아보셔도 좋을 것 같습니다.

엑세스 리스트는 앞으로 라우터의 실제 구성할 때뿐만 아니라 여러 가지 자격 시험에서도 빈번히 출제되는 문제이기도 합니다. 혹시 시스코 자격증을 준비하는 분이라면 이번 기회에 꼭 이해해 두기 바랍니다.

자, 그럼 엑세스 리스트를 시작합니다.

엑세스 리스트는 앞에서 말씀드린 대로 라우터의 문지기라고 생각하면 쉽습니다. 이런 엑세스 리스트도 종류가 있습니다. 크게 두 가지라고 볼 수 있는데, 첫 번째가 스탠더드 엑세스 리스트(Standard Access List)라고 또 하나가 있는데, 이것은 자주 쓰이지는 않지만 가끔 시험에 나오곤 합니다.  
이것은 유저 네임(User Name)과 패스워드에 따라 통제가 가능한 엑세스 리스트입니다.

여기에서는 스탠더드 엑세스 리스트(Standard Access List)와 익스텐디드 엑세스 리스트(Extended Access List)까지만 알아보도록 하겠습니다.

자, 스탠더드 엑세스 리스트의 가장 큰 특징은 출입 통제를 할 때 출발지 주소만 참고한다는 겁니다. 즉 스텐더드 엑세스 리스트는 출발지 주소만 가지고 제어를 합니다. 이것이 어디서 왔는가를 본 다음, 통과 여부를 결정하는 것입니다.

하지만 익스텐디드 엑세스 리스트는 출발지도 보고, 목적지도 보고, 또 프로토콜도 보고, 사용 포트 번호도 보고 아무튼 온갖 것을 다 본 다음에 통과 여부를 결정합니다.

라우터 엑세스 리스트를 많이 해본 사람들도 스텐더드 엑세스 리스트를 세팅할 때 출발지 주소를 보는지, 목적지 주소를 보는지 혼동한다거나, 아니면 익스텐디드 엑세스 리스트를 세팅할 때 출발지가 먼저 오는지, 목적지가 먼저 오는지를 가지고 혼동할 때가 있는데, 여러분은 잘 기억해 두기 바랍니다.  
그리고 또 하나 알아두셔야 할 것 한 가지! 이것은 시험에 나오니까 혹시 자격증 공부하는 분은 꼭 알아두기 바랍니다.

만약 엑세스 리스트에 걸려서 못 들어가는 경우 라우터에 어떤 메시지가 나타날까요? 그건 'Host Unreachable'이란 말이 나온다는 겁니다. 나중에도 설명할 기회가 있겠지만 일단은 답이랃로 알아두는 것이 좋습니다.



> 알고 갑시다!

라우터에서 네트워크에 대한 보안을 위해 사용되는 것이 바로 엑세스 리스트라는 것인데, 엑세스 리스트에는 스탠더드 엑세스 리스트와 익스텐디드 엑세스 리스트가 있다(다이내믹 엑세스 리스트도 있지만 여기에서는 일단 생략).   
스탠더드 엑세스 리스트는 무조건 출발지 주소만 보고 결정을 하고, 익스텐디드 엑세스 리스트는 있는 조건은 다 따진다.



## 엑세스 리스트에서 이것만 알면 다 안다!

이번에는 엑세스 리스트에서 가장 중요한, 즉 엑세스 리스트의 노른자를 배워보도록 하겠습니다. 사람들이 엑세스 리스트를 하면서 어렵다고 하는 이유도, 그리고 엑세스 리스트에서 자꾸 에러가 걸리는 이유도 사실은 이 규칙을 완전하게 이해하고 있지 못하기 때문입니다.

또 알고 있다고 하더라도 잊어버리기 쉬우므로, 이번에 정말 완벽하게 이 규칙을 자신의 것으로 만들기를 바랍니다.

엑세스 리스트에서 가장 중요한, 잊어버리면 안 되는 4가지 규칙을 이제부터 하나하나 알아보기로 하겠습니다.

![](./img/2-2/ex1.jpg)

만약 4개의 엑세스 리스트가 있다면 맨 윗줄이 수행되고 그 다음 줄로 내려온다는 겁니다.

별거 아닌 것 같지만 중요합니다. 앞으로 예를 들어 설명을 드리겠습니다. 아무튼 지금은 그냥 외우세요.

![](./img/2-2/ex2.jpg)

엑세스 리스트는 맨 마지막 줄에는 항상 모든 것을 막아버리는 deny all이 들어있다고 생각하고 있습니다. 그러니까 어떤 엑세스 리스트의 항목에도 해당하지 않는 주소가 있다면, 그 주소는 맨 마지막 줄까지 내려온 후 deny all에 걸려서 모두 막혀버리는 겁니다.

따라서 2번 규칙을 까먹고 엑세스 리스트를 구성하는 경우는 막고 싶지 않는 것들도 실수로 모두 막혀버리는 아주 불행한 사태가 발생하는 겁니다. 조심, 조심, 또 조심하셔야 합니다.

![](./img/2-2/ex3.jpg)

예를 한번 들어 볼까요? 지금 여러분은 어렵게 배운 라우터의 엑세스 리스트를 만들어 나가고 있습니다. 여러분이 있는 곳은 라우터의 구성 모드입니다.

![](./img/2-2/ex4.jpg)

아직 여기 있는 엑세스 리스트가 무엇을 의미하는지는 모르셔도 됩니다. 대충 익스텐디드 엑세스 리스트(Extended Access List)가 이렇게 생겼구나라고만 알아두기 바랍니다.

자, 여기 보이는 것처럼 열심히 어려운 엑세스 리스트를 구성했습니다. 그런데 모든 구성을 마치고 나와서 가만히 생각해보니까 엑세스 리스트의 명령어 중 위에서 두 번째가 잘못된 거였습니다.  
즉 IP 주소가 201.222.11.7이어야 하는데 그만 205.222.11.7로 잘못 입력하게 된 겁니다. 그럼 고쳐야겠죠? 그래서 다시 구성 모드로 들어갔습니다.  
명령어를 지울 때는 명령어 앞에 no를 붙이면 된다고 했으니까 이렇게 먼저 잘못 내린 명령을 no를 이용해서 지운 다음에 다시 제대로 된 명령어를 입력했습니다.

![](./img/2-2/ex5.jpg)

대부분의 경우 구성을 변경할 때는 이런 방식을 사용하는 것이 맞습니다. 그러나 엑세스 리스트에서 이런 방식을 사용하게 되면 그동안에 입력되었던 나머지 모든 엑세스 리스트는 지워지게 됩니다. 이렇게 하고 나서 show running-config를 보게 되면,

![](./img/2-2/ex6.jpg)

위에서처럼 맨 마지막에 입력한 한 줄의 엑세스 리스트만 남게 됩니다. 그러니 항상 주의하셔야합니다. 절대 잊지 마세요. 아주 큰 낭패를 볼 수도 있습니다.

![](./img/2-2/ex7.jpg)

엑세스 리스트가 정의되어 있지 않은 인터페이스는 엑세스 리스트를 거치지 않고 바로 통과되기 때문에 당연히 permit any가 되는 겁니다.

이것은 2번 규칙과 혼돈하면 안 됩니다. 2번은 엑세스 리스트는 정의되었지만, 자기가 속할 엑세스 리스트가 없는 것이고, 4번은 아예 자기 네트워크에는 엑세스 리스트도 정의되어 있지 않은 경우이기 때문입니다.



> 알고 갑시다!

엑세스 리스트를 움직이는 4가지 규칙이 있는데, 첫 번째는 윗줄부터 아래로 차례로 수행된다는 것,  
두 번째는 엑세스 리스트의 맨 마지막에는 deny all이 생략되어 있다는 것, 세 번째는 엑세스 리스트에서 중간에 있는 엑세스 리스트를 지우려고 하면 모든 엑세스 리스트가 다 지워진다는 것, 네 번째는 인터페이스에 엑세스 리스트 명령이 없으면 그건 permit all이라는 것이다.

4가지의 엑세스 리스트 규칙은 엑세스 리스트 사용 시에 아주 중요한 거니까 모두 외워야 하고 못 외우면 잘 보이는 곳에 메모해 두세요!



> 네트워크 플러스+

### 네트워크의 혼잡, 컨제션에 대한 이야기


# 세상은 넓고 네트워킹은 계속된다



## 목차

- [WAN은 어렵다?](#wan은-어렵다-)
- HDLC보다 괜찮은 PPP
- 프레임 릴레이(Frame Replay)의 구성
- ISDN의 추억




## WAN은 어렵다?

네트워킹을 하다 보면 듣는 이야기 중 하나가 바로 "WAN은 어렵다"는 말입니다. 그건 아마 기술이 어렵다기보다는 개념이 어렵다는 뜻일 겁니다. LAN은 바로 눈앞에 보이기 때문에 문제가 생기면 하나하나 만져보면서 문제를 해결할 수 있지만, WAN은 나 혼자만 잘한다고 되는 문제가 아니고, 또 전부 만져볼 수 있는 것도 아니기 때문에 더욱 어렵게 느껴집니다.  
하지만 WAN의 기본 개념을 튼튼하게 잡고, 내가 해야 할 부분과 전화국(통신 선로 담당)에서 해야 할 부분을 명확히 구분할 수 있다면 큰 문제가 안 됩니다. 사실 우리는 이미 WAN을 사용하는 데 너무나도 익숙해져 있기 때문이죠.

우리 곁의 WAN은 바로 전화기입니다. 하루에도 몇 번씩 울리는 휴대폰, 그리고 가정과 사무실에 한 대씩 자리하고 있는 유선 전화기, 팩스, 모뎀 같은 것들이 모두 WAN 장비입니다. 하지만 전화기를 쓰면서 어렵다는 생각을 하지는 않죠?  
마찬가지로 WAN 역시 그리 어려운 것이 아닙니다. 자주 쓰다 보면 금방 친숙해질 겁니다. 마치 우리 주머니 안에 있는 작고 예쁜 휴대폰처럼요.

자, 그럼 WAN이 무엇인가에 대해서 슬슬 알아볼까요? WAN이란, 한마디로 내가 직접 네트워크 케이블을 깔아서 통신을 연결할 수 없을 때 사용하는 네트워킹 방식입니다.

Wide Area Network라는 말처럼 넓은 지역에서는 네트워킹을 하기 위해 직접 케이블을 설치해서 통신한다는 것이 쉽지도 않을 뿐만 아니라 비용 측면에서도 결코 효율적이지 못합니다.  
서울에 사는 사람이 부산에 사는 친구와 전화를 하겠다고 서울에서 부산까지 전화 케이블을 까는것과 마찬가지죠.  
그때는 차라리 전화국을 통해 전화를 하는 것이 더 경제적이라는 겁니다. 마찬가지로 넓은 지역의 네트워킹에서도 중간에 통신 회사를 통해서 네트워킹을 구축하게 되는데, 이게 바로 가장 일반적인 WAN의 구성입니다.

WAN은 사용하는 목적, 사용료, 거리, 방법 등에 따라 다양한 종류가 있습니다. WAN이 어려운 이유 중의 하나도 바로 WAN의 구현 방법이 여러 가지이기 때문일 겁니다. 하지만 여러 가지 WAN의 방법도 다음 3가지 정도로 구분이 가능합니다.

- 전용선 방식(Leased Line) : 영어로 'Leased Line'이니, '임대회선'이라고 하는 것이 맞겠지만 일반적으로는 '전용선'이라고 부릅니다. 이 방식은 말 그대로 전화국과 같은 통신사업자에게 통신회선을 임대받아서 쓰는 방식입니다.  
  예를 들어 서울에서 부산까지 통신을 해야 한다면 통신사업자가 서울에서 부산까지 이미 설치해 놓은 회선 중 하나를 우리는 돈을 내고 대여해서 쓰는 겁니다. 나 혼자 빌려서 쓰는 것이니 마치 내가 설치한 통신회선처럼 사용할 수 있어 좋겠죠? 보안에도 크게 신경쓸 필요가 없지만 비용이 좀 많이 든다는 단점이 있습니다.  
  Leased Line을 전용선이라고 하는 이유가 이제 이해되시죠? 나 혼자만 쓸 수 있는 전용 라인이기 때문입니다.
- 회선 스위칭 방식(Circuit Switched) : 이 방식은 전용선 방식과는 달리 내가 통신을 하는 순간에만 나에게 필요한 회선을 열어주고 통신이 끝나면 회수하는 방식입니다. 이렇게 설명하니 꽤 복잡한 기술 같지만 우린 이미 서킷 스위칭 방식을 경험하고 있습니다.  
  가장 일반적인 것이 전화입니다. 전화를 걸 때 수화기를 들고 상대방의 전화번호를 누릅니다. 상대가 전화를 받으면 이때부터 전화국에서는 나에게 통신회선을 하나 열어준 것입니다. 내가 통화할 수 있게 말이죠.  
  전화가 끝나고 내가 수화기를 내려놓으면 전화국에서는 내가 사용했던 회선을 다시 회수해 갑니다. 이처럼 내가 통신하는 순간에만 나에게 회선을 쓸 수 있게 해주는 방식이 바로 서킷 스위칭 방식입니다. 방금 예를 들었던 전화뿐만 아니라 모뎀이나 ISDN 같은 경우가 이 방식에 해당합니다. 모두 다이얼을 돌려 상대와 연결해서 통신하고, 통신이 끝나면 회선을 반납하는 방식입니다.
- 패킷 스위칭 방식(Packet Switched) : 이 방식은 좀 다릅니다. 패킷 스위칭에서는 우리가 통신하는 순간에도 우리에게 통신회선 전체를 다 빌려주는 것이 아닙니다. 말 그대로 패킷 하나하나가 나뉘어서 통신회선을 타고 목적지까지 전달되는 방식이기 때문에 엄밀히 말하면 통신 회선을 다른 사람들과 나눠서 쓰는 방식이 바로 패킷 스위칭입니다.  
  따라서 패킷 스위칭 방식으로 통신을 할 때 실제로는 내가 가진 회선이 없지만 마치 내가 목적지까지의 회선을 가지고 있고, 데이터를 그 회선을 통해 전달하는 것처럼 동작하도록 해주어야 하는데, 이 목적 때문에 Virtual Circuit과 같은 개념이 나오게 됩니다.  
  버추얼 서킷이란, 앞에서 설명한 대로 사실은 나에게 배정된 회선이 없는데 마치 있는 것처럼 통신하는 방식입니다. 대표적인 패킷 스위칭 통신 방식은 프레임 릴레이, ATM, X25 등이 있습니다.

아래 그림을 보시면 지금까지 설명드린 3가지 WAN 방식이 나와 있습니다. WAN 방식에 따라 우리가 사용하는 접속 방식 역시 차이가 있습니다.

![](./img/2-3/ex1.jpg)

> 질문 있어요! QnA

Q WAN을 공부하다 보면 혼동되는 말이 나오는데, CPE라는 말과 Demarc라는 말이 있네요. 그리고 DTE, DCE는 또 뭔가요? 속 시원하게 설명 좀 해주세요!

A 네, CPE(Customer Premises Equipment)란, 쉽게 '고객이 가진 장비' 정도의 뜻으로 해석이 됩니다. 즉 고객 사이트에 있는 장비라고 보시면 되는데, 라우터, DSU/CSU 같은 장비가 바로 CPE 장비의 예입니다. 그럼 고객 사이트에 있는 스위치, 허브, 랜 카드도 CPE 장비가 아니냐고 물으실 텐데, 그것 역시 CPE라고 볼 수 있습니다.  
하지만 CPE라는 말은 주로 WAN쪽 서비스에서 통신사업자 장비와 고객장비를 구분하는 용도로 쓰이기 때문에 일반적으로 WAN과 관련된 DSU/CSU, 라우터까지 지칭합니다.

Demarc 또는 Demarcation은 우리말로 '경계'를 의미합니다. 즉 어디까지가 고객이 책임지는 부분이고, 어디까지가 서비스 제공자가 책임지는 부분이냐를 나눌 때 쓰는 말이죠. 이 이야기는 주로 WAN쪽에 문제가 생겼을 때 어디서부터 서비스 제공자(통신 사업자)가 책임을 지는가를 결정하기 위해 만들어진 용어로, 주로 DSU/CSU와 라우터쪽은 고객 책임이고, 회선부터는 통신사업자 책임이 됩니다.

사실 WAN을 구축하다 보면 이런 일이 많습니다. 예를 들어 서울과 부산 간의 통신이 갑자기 끊어졌다면, 네트워크 엔지니어는 이 문제가 라우터나 DSU/CSU 같은 고객쪽 장비 문제인지, 회선 같은 통신사업자 문제인지를 재빨리 알아내야 합니다.  
그러기 위해서는 장비뿐만 아니라 회선에 대해서도 많은 지식과 경험이 필요합니다. 그래야 전화국과 싸워서 이길 수 있겠죠? 잘못하면 우리쪽 문제가 아닌데도 책임을 뒤집어 쓰는 경우가 있거든요. 그만큼 WAN쪽은 경험이 중요합니다.  
회선도 살려보고 전화국 선로 담당자와도 자주 이야기를 해봐야 감을 잡기가 쉽답니다. 역시 해보는 것 밖에는 별다는 방법이 없죠?

DTE(Date Terminal Equipment)는 말 그대로 데이터가 WAN쪽으로 여행을 시작하는 터미널 같은 곳입니다. 사용자와 네트워크로 구분을 했을 때 사용자측에서 데이터의 송신이나 수신의 용도로 사용되는 장비니까 라우터가 대표적인 DTE가 되겠네요.  
반면 DCE(Data Communications Equipment 또는 Date Circuit-terminating Equipment)는 사용자와 네트워크로 구분을 했을 때 네트워크측으로의 연결 역할을 담당하는 연결 통로를 제공해줍니다. 대표적인 장비로 DSU/CSU가 있겠죠. 그리고 DCE는 여러분이 아시는 대로 클록을 제공한다는 특징을 가지고 있습니다.



## HDLC보다 괜찮은 PPP

이번에는 우리가 라우터의 시리얼(Serial) 라인에서 주로 사용하는 HDLC(High-level Data Link Control)에 대해서 간단히 알아보겠습니다.  
사실 HDLC는 PPP에 비해 그리 좋은 프로토콜은 아닙니다. PPP는 여러 가지 프로토콜을 통합해서 인캡슐레이션하는 기능, 다양한 보안 기능이 있어 HDLC보다 효과적입니다.  
특히 시스코 라우터의 시리얼 라인에서 디폴트로 사용하는 HDLC는 시스코만의 방식으로 표준 HDLC 프로토콜이 아닙니다.

> 알고 갑시다!

<b>HDLC는 표준 프로토콜일까요. 아닐까요?</b>

답은 바로 HDLC는 표준 프로토콜이다. 하지만 시스코에서 사용하는 HDLC는 표준 프로토콜이 아니다. 표준 HDLC는 그렇게 효과적인 프로토콜이 아니었다.  
지원하는 프로토콜도 하나밖에 안 된다. 하지만 시스코 HDLC는 여러 개의 프로토콜을 지원한다는 장점이 있다. 표준 HDLC 프로토콜보다 효과적인 HDLC를 시스코 라우터에서 사용하기는 하지만, 표준이 아니기 때문에 시스코 라우터와 다른 회사의 라우터를 서로 시리얼로 연결하는 경우에는 HDLC를 쓰면 안 된다.  
그럴 때는 PPP를 사용하는 것이 좋은데 실제 구성 시 이 문제 때문에 WAN을 살리지 못하고 고생하는 경우가 종종 있다. 똑같이 HDLC 인캡슐레이션을 썼는데 통신이 안 되니 괜히 회선이 문제가 있다느니, 장비가 고장이 났다느니 하면서 고생고생하는 것이다.

여러분도 특히 조심해야 합니다. 이상입니다.



그럼 라우터에서는 어떻게 HDLC를 Enable할까요? 일단 시리얼 인터페이스에는 디폴트로 Enable되어 있죠? 하지만 모뎀 라인과 같은 Async 라인에서 Enable해줄 필요가 있을 때는 다음 명령을 사용합니다.

![](./img/2-3/ex2.jpg)

위 그림을 보시면 표준 HDLC와 시스코의 HDLC가 비교되어 있습니다. 확실히 다르긴 다르죠? 혹시 시스코 라우터의 시리얼 인터페이스에 디폴트로 인캡슐레이션되어 있는 HDLC를 어디서 확인해야 하는지 모르는 분들을 위해 show interface에서 나오는 결과도 같이 정리했으니 확인해 보세요.

![](./img/2-3/ex3.jpg)

이제 PPP를 좀 알아볼까요? PPP(Point-to-Point) 프로토콜 WAN에서 가장 일반적인, 그리고 가장 괜찮은 인캡슐레이션 방식입니다.  
물론 시스코 장비를 쓰다 보면 전용선 같은 시리얼 라인에서는 주로 HDLC를 사용하게 되지만, ISDN 방식에서나 모뎀 접속에서는 거의 대부분의 접속을 PPP를 이용해서 구현하게 됩니다. (시리얼 라인에서도 PPP 사용은 가능한데, 타사 장비와 연결할 때는 PPP를 써야겠죠?)  
PPP는 강력한 보안기능과 여러 가지 네트워크 계층 프로토콜을 한꺼번에 지원하는 장점을 가진 표준 프로토콜이라는 것만 기억하시기 바랍니다.

PPP가 멀티프로토콜을 지원하고 강력한 보안기능을 지원하는 것은 PPP 안에 살고 있는 두 형제 때문입니다. 그것은 바로 NCP와 LCP입니다. (형제이다 보니 돌림자가 CP로 같네요.)  
NCP(Network Control Protocol)는 IP, IPX, AppleTalk 등 멀티프로토콜 지원을 책임지고 있고, LCP(Link Control Protocol)는 링크 접속에서의 보안, 에러 체크, 압축기능 및 멀티링크 PPP와 같은 다양한 접속 옵션을 제공합니다.

우리가 일반적으로 LCP를 주목하는 이유는 바로 보안기능 때문입니다. LCP는 여러 가지 기능중에서 보안기능을 제공함으로써 안전한 PPP 통신을 책임집니다. 아래 그림을 보면 LCP의 보안인증 과정은 데이터 링크 계층의 세션을 맺고 나서 네트워크 계층 간의 통신이 일어나기 직전에 발생합니다.  
다시 한 번 정리해 보면 먼저 데이터 링크 계층을 서로 연결하고, 그다음에 보안인증을 거친 후 보안인증 과정을 무사히 마치면 마지막으로 네트워크 계층을 서로 연결하게 되는 겁니다. (순서가 이해되시죠? 가끔 시험에도 나오는 것이니 잘 알아두세요.)

![](./img/2-3/ex4.jpg)

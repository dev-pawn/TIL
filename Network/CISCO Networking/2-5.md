# IPv6로 떠나는 여행



## 목차

- IPv6, 왜 필요한 걸까요?
- IPv6의 탄생
- 왜 갑자기 IPv4에서 IPv6로 뛰었을까요?
- IPv6에서 무엇이 달라졌냐고 묻는다면...
- IPv6의 주요 특징에 대한 첫 번째 이야기
- IPv6의 주요 특징에 대한 두 번째 이야기
- IPv6 주소는 어떻게 생겼을까요?
- IPv6와의 어색한 동거
- 라우터에서 IPv6의 구성



## IPv6, 왜 필요한 걸까요?

몇 년 전 하지만 그땐 네트워크가 무엇인지만 알아도 괜찮은 시절이었습니다. 하지만 이젠 네트워크도 너무 방대한 분야로 나뉘었고 또 하루가 다르게 변해가고 있습니다. 정말 하루라도 네트워크에 관한 기술의 발전이 멈춘 날이 없는 것 같습니다.

그 많은 네트워킹 기술 중에서 이번에는 IP version 6에 대한 이야길 들려드릴까 합니다.

몇 년 전부터 들리기 시작한 IP version 6(줄여서 IPv6라고 합니다.)는 벌써 우리와 너무도 가까운 곳에 와 있고, 또 곧 우리 모두에게 몰아닥칠 새로운 IP의 세상입니다.

저와 조금 먼저 IPv6에 대해 알아보고 준비하신다면 아마 낯설게 다가온 IPv6가 조금은 더 친숙하게 느껴지지 않을까 생각합니다.

자, 서론은 여기까지만 하구요. 이야기 시작합니다.

그럼 먼저 IPv6가 왜 나왔는지부터 차근차근 알아보도록 하겠습니다. 이미 눈치채셨겠지만 IPv6의 출현 이유 첫 번째는 IPv4 주소의 주소 공간 부족입니다.

1981년도부터 본격적으로 사용하게 되었던 IP version 4는 1985년에는 전체 주소의 1/16을 사용했으니 그때까지만 해도 주소 부족을 걱정할 필요는 없었을 겁니다. 그런데 1991년 World Wide Web이란 게 개발되고, 1993년엔(이젠 우리의 아련한 기억 속에 웹 브라우저의 할아버지로 기억되고 있는) 모자이크(Mosaic)가 발표되었습니다.  
그러다 보니 IP 주소의 사용이 점점 늘어나게 되면서 1995년에는 전체 주소의 1/3을, 2000년에는 1/2를 사용하게 되었습니다.

아시다시피 IPv4는 32비트 주소 체계니까 이론적으로 2<sup>32</sup> 만큼의 주소를 만들 수 있습니다.

그게 얼마냐구요?

약 43억 개 정도가 됩니다.

그러나 그걸 다 쓸 수는 없답니다. 일단 중간중간에 Private용 등으로 예약된 주소 영역이 있구요. 또 클래스 E는 연구용으로 사용되니 막상 쓸 수 있는 주소는 훨씬 적은 수가 되겠죠. 따라서 현실적으로 배정이 가능한 IP 주소는 약 2억 5,000만 개 정도밖엔 되지 않는다고 합니다.

정말 적죠?

2억 5천만 개가 왜 적냐구요? 그 정도면 충분하지 않냐구요?

그렇지 않습니다.

현재 네트워크의 수는 매년 약 2배로 증가하고 있답니다. 이와 함께 인터넷의 사용자와 장비 역시 기하급수적으로 늘어나고 있습니다.

2001년도 현재 인터넷 사용자 수는 약 4억 2천만 명이라고 하니까 벌써 공인주소의 약 2배 정도의 수가 인터넷을 쓰는 겁니다만, 4억 명이라고 해봐야 전 세계 인구의 1/10도 안 되는 수입니다.  
게다가 중국이나 인도, 러시아 등 인구가 무지하게 많은 나라들이 인터넷을 쓰기 시작했다고 하니, 이제 IP 주소의 부족은 불 보듯 뻔해지게 된 겁니다.

여러분께서도 동의하시죠?

그런데 문제는 이렇게 IP 주소를 사용하는 사람들이 늘어난다는 것이죠. 게다가 기존에 IP 주소를 주로 사용하던 PC나 컴퓨터뿐만 아니라 새로운 장비들이 자꾸 IP 주소를 사용하려고 한다는 것입니다. IP 전화기 아시죠? 언제부턴가 사무실 책상 위에 떡 하니 자리잡기 시작한 IP 전화기는 앞으로 몇 년 내에 일반 전화기들을 몰아낼 기세로 그 세력(?)이 커지고 있답니다.  
게다가 집에서는 인터넷 전화기라는 이름으로 전화기에 IP 주소를 하나씩 붙여서 나타난 애들이 저렴한 통화료를 내세워 집 전화를 집 밖으로 쫓아내기 시작했답니다. "집 나가면 개고생"이라고 하면서 말입니다.

TV도 바뀌고 있죠? IPTV로 말입니다. 그러고 보면 이제 IP란 말은 너무나도 흔하게 사용하는 말이 되어 버렸습니다. 초등학교 애들조차도 "아빠, 우리도 IPTV 설치하자."라고 이야기하는 걸 보면 말입니다.

아무튼 이런 추세라면 IP 주소는 곧 고갈 상태가 된다는 게 현재의 예측이랍니다.

우리에게는 이미 쓸 만한 IPv4 주소는 남아있지 않아 어떤 식으로든 주소 공간 확장에 대한 조치를 내릴 때가 온 겁니다.

이렇게 주소 공간 부족 이외에도 IP version 4의 문제점은 몇 가지 더 있을 수 있습니다.

현재 IP version 4가 가지고 있는 복잡한 헤더(Header)는 전체 필드를 불필요하게 늘리게 했고, 라우터로 하여금 효과적인 헤더 관리를 할 수 없게 한다는 문제를 낳기도 했습니다. 뿐만 아니라 IP 주소 배정 방식이 복잡하다는 문제도 있습니다.  
물론 DHCP(DHCP 다들 아시죠?)를 사용해서 이 문제를 해결할 수 있었지만 또 다른 서버의 구성이라는 오버헤드를 필요로 하게 되었습니다.  
또 주소가 부족하다 보니 주소 배정을 체계적으로 할 수 없어 몇 개의 라우팅 정보를 하나로 묶어주는 Aggregation이 어렵고, 따라서 라우팅 테이블은 점점 더 크고 복잡해질 수밖에 없었습니다.

이 밖에도 번거롭고 효율적이지 못했던 보안 기능과 Mobile IP의 지원 등은 IP version 4에서 해결해줘야 하는 문제점이었습니다.

자, 그렇다면 이떻게 해야 당장 이 문제를 해결할 수 있을까요? 먼저 주소 부족을 해결하기 위한 방법을 알아볼까요? 여러분들이 다 아시는 방법이 하나 있죠?

내부망에서는 Private IP 주소, 즉 내 맘대로 주소를 쓰고 밖으로, 즉 인터넷으로 나갈 때만 공인 IP 주소를 사용하는 겁니다.

이 방법은 이미 오래 전에 흥부네 집에서도 사용을 했던 방법입니다.

가족은 무지 많은데 입고 나갈 옷이 없었던 흥부네 가족은 외출복 몇 벌을 옷걸이에 걸어두고 집에 들어오면 옷을 벗어두고 모두 모여 이불 속에 머리만 내밀고 있다가 밖을 나갈 때만 그 옷을 입고 나가는 겁니다.  
이렇게 하면 가족 모두의 수만큼 옷이 있을 필요가 없겠죠? 밖에 나갈 녀석들만 옷을 입고 갔다 오면 벗어두고 또 다른 애가 나갈 때 그 옷을 입고 나가면 되니까요.

그게 바로 NAT(Network Address Translation)라는 겁니다.

내부에선 Private 주소를 사용하고 인터넷으로 나갈 때만 공인 IP 주소를 쓰게 되면 IP 주소가 몇 개 없어도 인터넷이 가능하다는 장점이 있습니다.

요즘 많이 사용하는 인터넷 공유기 역시 이런 원리를 이용한 것입니다. 하지만 이 방식은 옷이 1인당 하나씩 있을 경우 그냥 그 옷만 입고 나갔다 들어오면 되지만, 옷이 몇 벌 없으니 나갈 때와 들어올 때마다 옷을 갈아입어야 한다는 단점이 있습니다. 따라서 시간이 더 걸리겠죠? 즉 IP 주소를 변환해주는 시간이 필요하다는 겁니다.

그뿐만 아니라 여러 가지 End-to-End 기능을 지원하는 프로그램에서도 호환성에 문제가 있을 수 있습니다. 혹시 기억하시는지 모르겠지만 NAT를 사용할 때 인터넷 전화 프로그램이 간혹 안 되는 경험을 하셨을 겁니다.

이런 NAT라는 방법 이외에도 IPv4에서 주소 공간을 절약하기 위한 대표적인 방법은 바로 서브넷팅이 있습니다.

아시죠? 그 지긋지긋한 서브넷 마스크를 이용한 서브넷팅, 쉽게 말하면 네트워크를 잘게 쪼개 쓴다는 것인데, 주소가 많으면 뭐하러 잘게 쪼개서 쓰겠습니까? 주소가 부족하니까 쓸 만큼 쪼개 쓰고 나머지를 아끼는 거죠.

원래 맨 처음 IPv4 주소가 많았을 땐 서브넷팅이 그리 많이 사용되지 않았지만, 요즘은 서브넷팅 안 하는 곳은 거의 없을 뿐만 아니라 그 쪼개기도 점점 더 정교해졌다는 거죠.

이것 때문에 공부하는 여러분들만 죽을 맛이 된 거구요.

또 안 쓰는 주소는 자동으로 회수하고 주소가 필요한 PC에는 그때그때 주소를 배분해주는 DHCP(Dynamic Host Configuration Protocol)가 있습니다. DHCP를 사용하지 않을 경우 당장 사용을 하지 않는 IP 주소라고 하더라도 그 상태를 파악할 수 없으니 IP 주소 관리가 쉽지 않았던게 사실입니다. 하지만 DHCP를 사용하게 되면서 주소 배정의 편리함뿐만 아니라 안 쓰는 주소를 회수할 수 있어서 주소 낭비를 막을 수 있었습니다.

이 밖에도 클래스 A, B, C와 같은 기존의 약속을 무시하고 뒤에 붙은 서브넷 마스크만 가지고 클래스를 지정하는 방식인 CIDR(Classless Inter Domain Routing)이 있습니다. CIDR은 주로 서브넷팅과 반대 개념인 슈퍼넷팅, 즉 여러 개의 작은 네트워크를 1개로 모아서 라우팅 테이블을 줄여줌으로써 라우터의 메모리를 절약하고 라우팅 속도를 올려주기 위해 사용합니다.

IPv4에서의 주소 부족은 이와 같이 다양하고도 복잡한 주소 관리기법을 만들어냈고 네트워크는 점점 더 복잡해지게 된 겁니다.

자, 지금까지 배운 내용을 정리해볼까요?

현재 우리가 사용하고 있는 인터넷 주소 방식인 IP version 4는 그 사용자가 기하급수적으로 늘어나고, 또 네트워킹을 사용하는 장비가 늘어남으로써 주소 부족 상태를 낳고 있습니다. 현재까지 이 문제를 자체적으로 해결하기 위해 IPv4에서는 NAT을 비롯한 다양한 솔루션을 내놓고 있지만, 점점 더 복잡해지는 구성 방법과 End to End 지원이라는 문제에 부딪친 상태입니다. 또한 이런 방법으로도 주소 부족은 점점 더 심화되고 있습니다.

따라서 기존 IPv4를 대체하면서도 훨씬 개선된 새로운 IP 방식이 필요하게 되었는데, 그건 바로 다음 시간부터 자세히 알아볼 IP version 6입니다.



## IPv6의 탄생


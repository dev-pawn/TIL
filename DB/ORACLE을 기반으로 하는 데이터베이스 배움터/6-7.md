# 인덱스 선정 지침과 데이터베이스 튜닝

성능 목표를 만족시키기 위해서, 가장 중요한 질의들과 이들의 수행 빈도, 가장 중요한 갱신들과 이들의 수행 빈도, 이와 같은 질의와 갱신들에 대한 바람직한 성능들을 고려하여 인덱스를 선정하도록 한다.  
어느 애트리뷰트에 인덱스를 정의할 것인가를 결정하는 것이 항상 쉬운 일은 아니며 경험을 필요로 한다.  
인덱스 선정은 물리적 데이터베이스 설계자에게 가장 중요한 업무 중의 하나이면서 어려운 작업이다.

워크로드 내의 각 질의에 대해 이 질의가 어떤 릴레이션들을 접근하는가 어떤 애트리뷰트들을 검색하는가, WHERE절의 선택/조인 조건에 어떤 애트리뷰트들이 포함되는가, 이 조건들의 선별력은 얼마인가 등을 고려한다.  
워크로드 내의 각 갱신에 대해서도 이 갱신이 어떤 릴레이션을 접근하는가, WHERE절의 선택/조인 조건에 어떤 애트리뷰트들이 포함되는가,  
이 조건들의 선별력은 얼마인가, 갱신의 유형(INSERT/DELETE/UPDATE) 갱신의 영향을 받는 애트리뷰트 등을 고려한다.

어떤 릴레이션에 인덱스를 생성해야 하는가, 어떤 애트리뷰트를 탐색 키로 선정해야 하는가, 몇 개의 인덱스를 생성해야 하는가,  
각 인덱스에 대해 클러스터링 인덱스, 밀집 인덱스/희소 인덱스 중 어느 유형을 선택할 것인가 등을 고려한다. 가능하면 많은 질의가 도움을 받을 수 있는 인덱스들을 선정하려고 노력한다.  
릴레이션마다 한 개의 인덱스만 클러스터링 인덱스가 될 수 있으므로 클러스터링으로부터 가장 도움을 받을 수 있는 중요한 질의를 기반으로 선정한다.  
WHERE 절에 여러 조건들이 포함되어 있을 경우에는 복합 애트리뷰트로 이루어진 탐색 키를 고려할 수 있다.  
범위 선택이 포함되면 범위의 순서와 부합되도록 인덱스 정의 시 애트리뷰트들의 순서를 신중하게 명시해야 한다.  
때로 중요한 질의를 위해 인덱스만 탐색하는(릴레이션을 접근할 필요 없이) 밀집 인덱스를 선택한다. 인덱스만 고려하는 전략에서는 클러스터링 여부가 중요하지 않다.

인덱스를 선정하는 한 가지 방법은 가장 중요한 질의들을 차례대로 고려해보고, 현재의 인덱스가 최적의 계획에 적합한지 고려해보고, 인덱스를 추가하면 더 좋은 계획이 가능한지 알아본다.  
만일 그렇다면 그 인덱스를 생성한다. 인덱스를 생성하기 전에 워크로드 내의 갱신에 미치는 영향도 고려해야 한다.

물리적인 데이터베이스 설계는 끊임없이 이루어지는 작업이다. DBMS가 ANSI/SPARC 아키텍처에 부합될수록 사용 패턴처럼 계속해서 변하는 요구사항들을 보다 잘 만족시킬 수 있도록 물리적인 구조를 변경하는 것이 쉽다.  
따라서 물리적 데이터베이스 설계는 데이터베이스를 구축할 때 한 번 인덱스들을 정의하고 끝내는 업무가 아니고, 데이터베이스를 사용하는 라이프 사이클 동안 반복적으로 수행되어야 하는 작업이다.

물리적 데이터베이스 설계를 잘하기 위해서는 접근 패턴과 같은 정보를 필요로 하는데, 데이터베이스가 운영되기 전에는 이에 관한 실제적인 정보를 얻기가 힘들다.  
현업의 사용자들은 데이터베이스 설계자에게 그들이 실제로 대부분의 시간을 투입하는 업무(따라서 이런 업무를 효율적으로 지원하는 것이 더 중요함)보다  
그들이 직장 생활을 흥미롭게 만드는 업무에 대해서 더 자세하게 설명하는 경향이 있다.  
실제로 사용자가 어떻게 데이터베이스 시스템을 사용하는가를 파악해서 이를 어떻게 효율적으로 지원할 것인가를 미리 결정하는 것은 매우 어렵다.

그러나 그렇다고 해서 접근 패턴을 분석하는 작업을 무시해도 되는 것은 아니다. 가능성이 높은 접근 패턴들을 파악하도록 노력하고 DBMS가 얼마나 이런 접근 패턴에 잘 대응할 것인가를 예상한다.  
만일 어떤 문제가 존재할 것으로 생각되면 가능한 해결 방안을 모색한다. 해결 방안을 쉽게 구현할 수 있으면 실제로 문제가 발생할 때까지 기다렸다가, 문제가 발생한 후에 해결 방안을 구현해도 무방하다.



## 목차

- 인덱스를 결정하는 데 도움이 되는 지침
- 언제 인덱스가 사용되지 않는가?
- 질의 튜닝을 위한 추가 지침




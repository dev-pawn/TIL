# 제1정규형, 제2정규형, 제3정규형, BCNF

정규형에는 제1정규형, 제2정규형, 제3정규형, BCNF, 제4정규형, 제5정규형 등이 있지만  
일반적으로 데이터베이스를 설계할 때 3NF 또는 BCNF까지만 고려하므로 BCNF까지만 살펴본다.



## 목차

- 제1정규형
- 제2정규형
- 제3정규형
- BCNF



## 제1정규형

- 제1정규형의 정의

  한 릴레이션 R이 제1정규형을 만족할 필요충분조건은 릴레이션 R의 모든 애트리뷰트가 원잣값만을 갖는다는 것이다.  
  즉 릴레이션의 모든 애트리뷰트에 __반복 그룹(repeating group)__ 이 나타나지 않으면 제1정규형을 만족한다.  
  반복 그룹은 한 개의 기본 키값에 대해 두 개 이상의 값을 가질 수 있는 애트리뷰트를 의미한다.\

아래 그림의 학생 릴레이션에서 과목 번호 애트리뷰트는 각 학생이 수강하는 여러 과목들의 집합 값을 가지므로 제1정규형을 만족하지 못한다.  
릴레이션의 정의에 따르면 릴레이션의 각 애트리뷰트는 원잣값만 가질 수 있으므로, 모든 릴레이션은 적어도 제1정규형을 만족한다.  
실제로 아래 그림은 릴레이션이 아니다. 객체 지향 데이터베이스에서는 제1정규형을 완화하여 각 애트리뷰트가 원잣값이 아닌 집합, 리스트, 배열 등을 가질 수 있다.

![](./image/7-4/ex1.jpg)

제1정규형을 만족하지 않는 위 그림을 제1정규형으로 변환하는 한 가지 방법은 반복 그룹 애트리뷰트에 나타나는 집합에 속한 각 값마다 하나의 투플로 표현하는 것이다.  
아래 그림은 이런 방법을 적용하여 위 그림을 제1정규형을 만족하는 릴레이션으로 변환한 예를 보여준다.  
아래 그림의 제1정규형은 정보가 많이 중복되므로 갱신 이상을 유발한다.

![](./image/7-4/ex2.jpg)

제1정규형을 만족하지 않는 7.13 반복그룹을 1정규형으로 변환하는 또 다른 방법은 모든 반복 그룹 애트리뷰트들을 분리해서 새로운 릴레이션에 넣는다.  
원래 릴레이션의 기본 키를 새로운 릴레이션에 애트리뷰트로 추가한다.  
원래 릴레이션의 기본 키가 새로운 릴레이션에서도 항상 키가 되는 것은 아니다.  
아래 그림은 이런 방법을 적용하여 7.13 반복그룹을 제1정규형을 만족하는 릴레이션으로 변환한 예를 보여준다.

![](./image/7-4/ex3.jpg)



## 제2정규형

![](./image/7-4/ex4.jpg)

위 그림의 학생 릴레이션은 모든 애트리뷰트가 원잣값을 가지므로 제1정규형을 만족한다.  
이 릴레이션에 어떤 갱신 이상이 일어날 수 있는지 알아보자.  
한 한생이 여러 과목을 수강할 수 있으므로 이 릴레이션의 기본 키는 (학번, 과목번호)이다.

- 수정이상

  한 학과에 소속한 학생 수만큼 그 학과의 전화번호가 중복되어 저장되므로 여러 학생이 소속된 학과의 전화번호가 변경되었을 때  
  그 학과에 속한 모든 학생들의 투플에서 전화번호를 수정하지 않으면 데이터베이스의 일관성이 유지되지 않는다.  
  예를 들어, 컴퓨터학과의 전화번호가 바뀌었는데 첫 번째 투플에서만 수정하면 데이터베이스의 일관성이 깨진다.

- 삽입 이상

  한 명의 학생이라도 어떤 학과에 소속되지 않으면 이 학과에 관한 투플을 삽입 할 수 없다.  
  왜냐하면 학번이 기본 키의 구성요소인데 엔티티 무결성 제약조건에 따라 기본 키에 널값을 입력할 수 없기 때문이다.  
  예를 들어, 멀티미디어학과를 신설했는데 아직 학생을 선발하지 않았으면 이 학과에 관한 정보를 7.16 그림의 릴레이션에 삽입 할 수 없다.

- 삭제 이상

  어떤 학과에 소속된 마지막 학생 투플을 삭제하면 이 학생이 소속된 학과에 관한 정보도 삭제된다.  
  예를 들어, 정보통신학과에는 한 명의 학생만 소속되어 있는데, 이 학생의 투플을 삭제하면 정보통신학과에 관한 정보도 함께 삭제된다.

이와 같은 갱신 이상이 생기는 이유는 기본 키에 대한 부분 함수적 종속성이 학생 릴레이션에 존재하기 때문이다.  
즉 학과 이름과 학과전화번호는 학번에 부분적으로 종속한다.  
그림 7.17(a)는 그림 7.17의 학생 릴레이션에 존재하는 함수적 종속성들을 나타낸다.  
fd2는 완전 함수적 종속성을 나타내고, fd1은 부분 함수적 종속성을 나타낸다.

따라서 학생 릴레이션을 그림 7.17(b)와 같이 학생1 릴레이션과 수강 릴레이션으로 나누면 부분 함수적 종속성이 없어지며,  
두 릴레이션은 제2정규형을 만족한다. 그림 7.17(b)의 수강 릴레이션에서 학점은 기본 키에 완전하게 함수적으로 종속한다.  
또한 위에 기술한 갱신 이상이 발생하지 않는다.

두 릴레이션으로 분해할 때 원래 릴레이션에서 기본 키에 부분적으로 종속되는 애트리뷰트(예: 그림7.17(a)에서  
학과이름과 학과전화번호)들은 한 릴레이션(예: 그림 7.17(b)에서 학생1 릴레이션)에 속하도록 한다.  
이 애트리뷰트들이 부분적으로 종속됐던 애트리뷰트(예: 그림 7.17(a)에서 학번)가 이 릴레이션의 기본 키가 된다.  
원래 릴레이션의 나머지 애트리뷰트들이 또 다른 릴레이션(예: 그림 7.17(b)에서 수강)에 포함되며 학번 애트리뷰트를 외래 키로 이 릴레이션에 포함시킨다.  
학생1 릴레이션의 기본 키는 한 애트리뷰트로 이루어지므로 제2정규형을 만족한다.  
수강 릴레이션의 기본 키는 복합 애트리뷰트인 (학번, 과목번호)이지만 학점 애트리뷰트가 기본키에 완전하게 함수적으로 종속하므로 제2정규형을 만족한다.

![](./image/7-4/ex5.jpg)

- 제2정규형의 정의

  한 릴레이션 R이 제2정규형을 만족할 필요충분조건은 릴레이션 R이 제1정규형을 만족하면서,  
  어떤 후보 키에도 속하지 않는 모든 애트리뷰트들이 R의 기본 키에 완전하게 함수적으로 종속하는 것이다.

  기본 키가 두 개 이상의 애트리뷰트로 구성되었을 경우에만 제1정규형이 제2정규형을 만족하는가를 고려할 필요가 있다.  
  즉 기본 키가 한 개의 애트리뷰트로 이루어진 릴레이션이 제1정규형을 만족하면 제2정규형도 만족한다.

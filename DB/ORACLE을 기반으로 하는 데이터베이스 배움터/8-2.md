# 관계 DBMS의 시스템 카탈로그

DBMS는 사용자가 저장된 항목의 특성을 알아볼 수 있는 기능을 제공해야 한다.  
이런 기능은 질의 최적화 모듈 등 DBMS 자신의 구성요소에 의해서도 사용된다.  
시스템 카탈로그는 데이터베이스의 객체(릴레이션, 뷰, 인덱스 권한 등)와 구조들에 관한 모든 데이터를 포함한다.  
따라서 시스템 카탈로그를 메타데이터라고 한다. 메타데이터는 '데이터에 관한 데이터' 라는 뜻이다.  
시스템 카탈로그는 시스템의 사용자들에 관한 정보도 저장한다.  
예를 들어, 각 사용자가 접근 가능한 데이터베이스의 부분에 관한 정보뿐만 아니라 권한을 가진 사용자의 이름 등에 관한 정보도 저장한다.  
이들중의 일부 정보는 데이터베이스 관리자만 접근할 수 있다.

시스템 카탈로그는 관계 DBMS마다 표준화되어 있지 않아서 관계 DBMS마다 서로 다른 형태로 시스템 카탈로그 기능을 제공한다.  
시스템 카탈로그는 __데이터 사전(data dictionary)__ 또는 __시스템 테이블__이라고도 부른다.

시스템 카탈로그가 질의 처리에 어떻게 활용되는가를 살펴보자.  
예를 들어, "직급이 과장이고 2번 부서에 속하는 사원들에 대하여 사원이름과, 현재의 급여, 급여가 10% 인상됐을 때의 값을 검색하라."는 아래의 SELECT문을 살펴보자.

```SQL
SELECT	EMPNAME, SALARY, SALARY * 1.1
FROM 	EMPLOYEE
WHERE TITLE = '과장' AND DNO = 2;
```

DBMS가 이 SELECT문을 받으면 사용자가 원하는 투플들을 검색하기 위해서 몇가지 과정을 거친다.  
먼저 SELECT문이 문법적으로 정확한가를 검사한다. 즉 SELECT, FROM, WHERE와 같은 키워드들이 정확하게 표기됐는가,  
각 항목들 사이에 쉼표를 정확하게 표기했는가 등을 검사한다.  
SELECT문이 문법적으로 올바르게 작성되었으면 데이터베이스에 없는 릴레이션으로부터 정보를 검색할 수는 없으므로,  
이 SELECT문에서 참조하는 EMPLOYEE 릴레이션이 데이터베이스에 존재하는가를 검사해야 한다.  
또한 EMPLOYEE 릴레이션에 SELECT절에 열거된 애트리뷰트와 WHERE절에서 조건에 사용된 애트리뷰트가 존재하는가를 확인해야 한다.  
즉 EMPNAME, SALARY, TITLE, DNO 애트리뷰트가 EMPLOYEE 릴레이션에 포함되어 있는가를 검사한다.  
SALARY 애트리뷰트가 수식에 사용되었으므로 이 애트리뷰트의 데이터 타입이 숫자형(정수형이나 실수형)인가를 검사하고  
TITLE이 문자열과 비교 되었으므로 이 애트리뷰트의 데이터 타입이 문자형(CHAR(n) 또는 VARCHAR(n)등)인가를 검사한다.

지금까지의 확인 과정에 문제가 없으면 이 질의를 입력한 사용자가 EMPLOYEE 릴레이션의 EMPNAME, SALARY 애트리뷰트를 검색할 수 있는 권한이 있는가를 확인한다.

그 다음에 DBMS는 WHERE절에서 참조된 TITLE 애트리뷰트와 DNO 애트리뷰트에 인덱스가 정의되어 있는지 확인한다.  
두 애트리뷰트에 각각 인덱스가 존재한다고 가정하자.  
그러면 TITLE = '과장'을 만족하는 투플 수와 DNO = 2를 만족하는 투플 수 중에서 어느 것이 더 적은가를 알 필요가 있다.  
왜냐하면 EMPLOYEE 릴레이션의 모든 투플을 순차 탐색하면서 각 투플이 WHERE절을 만족하는가 검사하면 시간이 매우 오래 걸릴 수 있으므로 인덱스를 활용하는 효율적인 경우가 많기 때문이다.

TITLE = '과장' 과 DNO = 2를 모두 만족하는 투플만 사용자에게 결과로 제시되므로 TITLE에 정의된 인덱스와 DNO에 정의된 인덱스 중에서  
한 인덱스만 사용하여 그 인덱스에 관한 조건을 만족하는 투플을 검색한 후 나머지 조건도 만족하는가를 검사하면 된다.  
예를 들어, DBMS가 TITLE 인덱스를 사용하기로 결정했다면 EMPLOYEE의 투플들 중에서 TITLE = '과장'인 투플만 검색한 후 이 투플이 DNO 값이 2인가를 검사하면 된다.  
그러면 두 인덱스 중에서 DBMS가 어떤 인덱스를 선택하는 것이 질의 수행 시간을 단축할 수 있을까?  
조건을 만족하는 투플 수가 적은 인덱스가 당연히 유리하다. 이런 인덱스의 __선택율(selectivity)__이 높다고 말한다.  
DBMS가 두 인덱스중에서 조건을 만족하는 투플 수가 적은 것을 선택하기 위해서는 관계 데이터베이스 시스템에 데이터베이스 외에 추가로 정보를 유지해야 한다.  
한 릴레이션의 전체 투플수와 그 릴레이션에 정의된 각 인덱스에 존재하는 상이한 값들의 개수를 유지한다면 어느 인덱스를 사용하는 것이 유리한가를 예상할 수 있다.


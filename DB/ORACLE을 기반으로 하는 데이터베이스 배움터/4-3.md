# 데이터 정의어와 무결성 제약조건



## 목차

- [데이터 정의어](#데이터-정의어)
- 제약조건



## 데이터 정의어

![](./image/ddl.jpg)



### ○ 스키마의 생성과 제거

일반적으로 스키마는 특정 사용자의 데이터베이스 응용에 속하는 릴레이션, 도메인, 제약조건, 뷰, 권한 등을 그룹화한 것이다.

각 사용자는 권한을 허가받지 않는 한 다른 사용자의 스키마에 속한 데이터를 볼 수 없다.

__스키마는 CREATE SCHEMA문을 사용하여 생성__한다.

아래 문장은 TEST라는 계정을 가진 사용자가 TEST_DB라는 스키마를 생성한다.

```sql
CREATE SCHEMA TEST_DB AUTHORIZATION TEST;
```

여러 DBMS에서, 사용자를 생성하면 DBMS는 그 사용자에 대한 스키마를 자동적으로 할당한다.



기존의 __스키마를 제거 하려면 DROP SCHEMA문__을 사용한다.

스키마가 __비어 있지 않으면 DBMS가 DROP SCHEMA문을 거절__한다.

```sql
DROP SCHEMA TEST_DB;
```



### ○ 릴레이션 정의

SQL에서 __릴레이션을 정의하는 문은 CREATE TABLE문__이다.

```sql
CREATE TABLE DEPARTMENT
(DEPTNO	NUMBER	NOT NULL,
DEPTNAME CHAR(10),
FLOOR	NUMBER,
PRIMARY KEY(DEPTNO));

CREATE TABLE EMPLOYEE
(EMPNO	NUMBER	NOT NULL,
EMPNAME	CHAR(10),
TITLE	CHAR(10),
MANAGER	NUMBER,
SALARY	NUMBER,
DNO		NUMBER,
PRIMARY KEY(EMPNO),
FOREIGN KEY(MANAGER) REFERENCES EMPLOYEE(EMPNO),
FOREIGN KEY(DNO) REFERENCES DEPARTMENT(DEPTNO));
```

EMPLOYEE 릴레이션과 DEPARTMENT 릴레이션을 생성하는 기본적인 CREATE TABLE문은 위와 같다.

CREATE TABLE문에서 __한 릴레이션에 속하는 애트리뷰트들의 이름과 데이터 타입을 명시__한다.
애트리뷰트는 디폴트로 널값을 가질 수 있으므로 기본 키처럼 널값을 허용하지 않는 애트리뷰트에 대해서는 'NOT NULL'을 지정해야 한다.
또한 __어떤 애트리뷰트가 기본 키__이고, __어떤 애트리뷰트가 외래 키__로서 다른 릴레이션의 기본 키를 참조하는가를 __명시__한다.
CREATE TABLE문의 __수행결과로 빈 릴레이션__이 만들어진다.

릴레이션 및 애트리뷰트에 의미 있는 이름을 지정하는 것이 바람직하다.

위처럼 두 개의 릴레이션을 정의할 때 EMPLOYEE 릴레이션에서 DEPARTMENT 릴레이션의 기본 키를 외래 키로 참조하기 때문에 EMPLOYEE 릴레이션을 먼저 정의하면,
데이터베이스에 없는 DEPARTMENT 릴레이션의 기본 키를 참조하는 현상이 발생하므로 EMPLOYEE 릴레이션의 정의가 실패한다.
따라서 DEPARTMENT 릴레이션을 먼저 정의하고, 그 다음에 EMPLOYEE 릴레이션을 정의 해야 한다
또는 외래 키를 정의하는 절을 생략하고 EMPLOYEE 릴레이션과 DEPARTMENT 릴레이션을 생성한 후에 ALTER TABLE 문을 사용해서 EMPLOYEE 릴레이션에 참조 무결성 제약조건을 추가해도 된다.

위의 릴레이션 정의문에는 NUMBER와 CHAR(10)만 데이터 타입의 예로 들었지만 SQL에서 릴레이션의 정의에 다양한 데이터 타입을 사용할 수 있다.
DBMS마다 제공되는 데이터 타입에 다소 차이가 있다.

아래는 릴레이션의 정의에 사용되는 오라클의 데이터 타입들 중에서 자주 사용되는 것들을 요약한 것이다.

![](./image/oracledatatype.jpg)

애트리뷰트의 데이터 타입을 결정할 때 고려해야 할 사항은 다음과 같다.

숫자인지 문자인지를 먼저 결정한다.

문자인 경우에는

​	고정 길이 또는 가변 길이

​	최대 길이

숫자인 경우에는

​	정수 또는 실수

​	최대 길이

​	소수점 아래 개수



릴레이션이 더 이상 불필요하게 되면 언제든지 __DROP TABLE문을 사용하여 릴레이션을 제거__할 수 있다.
릴레이션의 정의와 릴레이션의 투플들이 모두 삭제된다.
다른 릴레이션이나 뷰에서 참조되지 않는 릴레이션들만 제거할 수 있다.

```sql
DROP TABLE DEPARTMENT;
```

만약 DEPARTMENT 릴레이션을 제거하려면 EMPLOYEE 릴레이션에서 DEPARTMENT 릴레이션을 참조하는 외래 키 정의를 ALTER TABLE문을 사용하여 먼저 제거해야 한다.
